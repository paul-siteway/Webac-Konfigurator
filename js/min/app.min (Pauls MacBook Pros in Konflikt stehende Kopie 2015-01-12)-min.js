(function(){var t=this,e=t._,n=Array.prototype,i=Object.prototype,s=Function.prototype,r=n.push,o=n.slice,a=n.concat,l=i.toString,c=i.hasOwnProperty,u=Array.isArray,h=Object.keys,d=s.bind,p=function(t){return t instanceof p?t:this instanceof p?void(this._wrapped=t):new p(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):t._=p,p.VERSION="1.7.0";var f=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,s){return t.call(e,n,i,s)};case 4:return function(n,i,s,r){return t.call(e,n,i,s,r)}}return function(){return t.apply(e,arguments)}};p.iteratee=function(t,e,n){return null==t?p.identity:p.isFunction(t)?f(t,e,n):p.isObject(t)?p.matches(t):p.property(t)},p.each=p.forEach=function(t,e,n){if(null==t)return t;e=f(e,n);var i,s=t.length;if(s===+s)for(i=0;s>i;i++)e(t[i],i,t);else{var r=p.keys(t);for(i=0,s=r.length;s>i;i++)e(t[r[i]],r[i],t)}return t},p.map=p.collect=function(t,e,n){if(null==t)return[];e=p.iteratee(e,n);for(var i=t.length!==+t.length&&p.keys(t),s=(i||t).length,r=Array(s),o,a=0;s>a;a++)o=i?i[a]:a,r[a]=e(t[o],o,t);return r};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(t,e,n,i){null==t&&(t=[]),e=f(e,i,4);var s=t.length!==+t.length&&p.keys(t),r=(s||t).length,o=0,a;if(arguments.length<3){if(!r)throw new TypeError(g);n=t[s?s[o++]:o++]}for(;r>o;o++)a=s?s[o]:o,n=e(n,t[a],a,t);return n},p.reduceRight=p.foldr=function(t,e,n,i){null==t&&(t=[]),e=f(e,i,4);var s=t.length!==+t.length&&p.keys(t),r=(s||t).length,o;if(arguments.length<3){if(!r)throw new TypeError(g);n=t[s?s[--r]:--r]}for(;r--;)o=s?s[r]:r,n=e(n,t[o],o,t);return n},p.find=p.detect=function(t,e,n){var i;return e=p.iteratee(e,n),p.some(t,function(t,n,s){return e(t,n,s)?(i=t,!0):void 0}),i},p.filter=p.select=function(t,e,n){var i=[];return null==t?i:(e=p.iteratee(e,n),p.each(t,function(t,n,s){e(t,n,s)&&i.push(t)}),i)},p.reject=function(t,e,n){return p.filter(t,p.negate(p.iteratee(e)),n)},p.every=p.all=function(t,e,n){if(null==t)return!0;e=p.iteratee(e,n);var i=t.length!==+t.length&&p.keys(t),s=(i||t).length,r,o;for(r=0;s>r;r++)if(o=i?i[r]:r,!e(t[o],o,t))return!1;return!0},p.some=p.any=function(t,e,n){if(null==t)return!1;e=p.iteratee(e,n);var i=t.length!==+t.length&&p.keys(t),s=(i||t).length,r,o;for(r=0;s>r;r++)if(o=i?i[r]:r,e(t[o],o,t))return!0;return!1},p.contains=p.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=p.values(t)),p.indexOf(t,e)>=0)},p.invoke=function(t,e){var n=o.call(arguments,2),i=p.isFunction(e);return p.map(t,function(t){return(i?e:t[e]).apply(t,n)})},p.pluck=function(t,e){return p.map(t,p.property(e))},p.where=function(t,e){return p.filter(t,p.matches(e))},p.findWhere=function(t,e){return p.find(t,p.matches(e))},p.max=function(t,e,n){var i=-1/0,s=-1/0,r,o;if(null==e&&null!=t){t=t.length===+t.length?t:p.values(t);for(var a=0,l=t.length;l>a;a++)r=t[a],r>i&&(i=r)}else e=p.iteratee(e,n),p.each(t,function(t,n,r){o=e(t,n,r),(o>s||o===-1/0&&i===-1/0)&&(i=t,s=o)});return i},p.min=function(t,e,n){var i=1/0,s=1/0,r,o;if(null==e&&null!=t){t=t.length===+t.length?t:p.values(t);for(var a=0,l=t.length;l>a;a++)r=t[a],i>r&&(i=r)}else e=p.iteratee(e,n),p.each(t,function(t,n,r){o=e(t,n,r),(s>o||1/0===o&&1/0===i)&&(i=t,s=o)});return i},p.shuffle=function(t){for(var e=t&&t.length===+t.length?t:p.values(t),n=e.length,i=Array(n),s=0,r;n>s;s++)r=p.random(0,s),r!==s&&(i[s]=i[r]),i[r]=e[s];return i},p.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=p.values(t)),t[p.random(t.length-1)]):p.shuffle(t).slice(0,Math.max(0,e))},p.sortBy=function(t,e,n){return e=p.iteratee(e,n),p.pluck(p.map(t,function(t,n,i){return{value:t,index:n,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var v=function(t){return function(e,n,i){var s={};return n=p.iteratee(n,i),p.each(e,function(i,r){var o=n(i,r,e);t(s,i,o)}),s}};p.groupBy=v(function(t,e,n){p.has(t,n)?t[n].push(e):t[n]=[e]}),p.indexBy=v(function(t,e,n){t[n]=e}),p.countBy=v(function(t,e,n){p.has(t,n)?t[n]++:t[n]=1}),p.sortedIndex=function(t,e,n,i){n=p.iteratee(n,i,1);for(var s=n(e),r=0,o=t.length;o>r;){var a=r+o>>>1;n(t[a])<s?r=a+1:o=a}return r},p.toArray=function(t){return t?p.isArray(t)?o.call(t):t.length===+t.length?p.map(t,p.identity):p.values(t):[]},p.size=function(t){return null==t?0:t.length===+t.length?t.length:p.keys(t).length},p.partition=function(t,e,n){e=p.iteratee(e,n);var i=[],s=[];return p.each(t,function(t,n,r){(e(t,n,r)?i:s).push(t)}),[i,s]},p.first=p.head=p.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:o.call(t,0,e)},p.initial=function(t,e,n){return o.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},p.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:o.call(t,Math.max(t.length-e,0))},p.rest=p.tail=p.drop=function(t,e,n){return o.call(t,null==e||n?1:e)},p.compact=function(t){return p.filter(t,p.identity)};var m=function(t,e,n,i){if(e&&p.every(t,p.isArray))return a.apply(i,t);for(var s=0,o=t.length;o>s;s++){var l=t[s];p.isArray(l)||p.isArguments(l)?e?r.apply(i,l):m(l,e,n,i):n||i.push(l)}return i};p.flatten=function(t,e){return m(t,e,!1,[])},p.without=function(t){return p.difference(t,o.call(arguments,1))},p.uniq=p.unique=function(t,e,n,i){if(null==t)return[];p.isBoolean(e)||(i=n,n=e,e=!1),null!=n&&(n=p.iteratee(n,i));for(var s=[],r=[],o=0,a=t.length;a>o;o++){var l=t[o];if(e)o&&r===l||s.push(l),r=l;else if(n){var c=n(l,o,t);p.indexOf(r,c)<0&&(r.push(c),s.push(l))}else p.indexOf(s,l)<0&&s.push(l)}return s},p.union=function(){return p.uniq(m(arguments,!0,!0,[]))},p.intersection=function(t){if(null==t)return[];for(var e=[],n=arguments.length,i=0,s=t.length;s>i;i++){var r=t[i];if(!p.contains(e,r)){for(var o=1;n>o&&p.contains(arguments[o],r);o++);o===n&&e.push(r)}}return e},p.difference=function(t){var e=m(o.call(arguments,1),!0,!0,[]);return p.filter(t,function(t){return!p.contains(e,t)})},p.zip=function(t){if(null==t)return[];for(var e=p.max(arguments,"length").length,n=Array(e),i=0;e>i;i++)n[i]=p.pluck(arguments,i);return n},p.object=function(t,e){if(null==t)return{};for(var n={},i=0,s=t.length;s>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},p.indexOf=function(t,e,n){if(null==t)return-1;var i=0,s=t.length;if(n){if("number"!=typeof n)return i=p.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,s+n):n}for(;s>i;i++)if(t[i]===e)return i;return-1},p.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=t.length;for("number"==typeof n&&(i=0>n?i+n+1:Math.min(i,n+1));--i>=0;)if(t[i]===e)return i;return-1},p.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=n||1;for(var i=Math.max(Math.ceil((e-t)/n),0),s=Array(i),r=0;i>r;r++,t+=n)s[r]=t;return s};var b=function(){};p.bind=function(t,e){var n,i;if(d&&t.bind===d)return d.apply(t,o.call(arguments,1));if(!p.isFunction(t))throw new TypeError("Bind must be called on a function");return n=o.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(o.call(arguments)));b.prototype=t.prototype;var s=new b;b.prototype=null;var r=t.apply(s,n.concat(o.call(arguments)));return p.isObject(r)?r:s}},p.partial=function(t){var e=o.call(arguments,1);return function(){for(var n=0,i=e.slice(),s=0,r=i.length;r>s;s++)i[s]===p&&(i[s]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},p.bindAll=function(t){var e,n=arguments.length,i;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)i=arguments[e],t[i]=p.bind(t[i],t);return t},p.memoize=function(t,e){var n=function(i){var s=n.cache,r=e?e.apply(this,arguments):i;return p.has(s,r)||(s[r]=t.apply(this,arguments)),s[r]};return n.cache={},n},p.delay=function(t,e){var n=o.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},p.defer=function(t){return p.delay.apply(p,[t,1].concat(o.call(arguments,1)))},p.throttle=function(t,e,n){var i,s,r,o=null,a=0;n||(n={});var l=function(){a=n.leading===!1?0:p.now(),o=null,r=t.apply(i,s),o||(i=s=null)};return function(){var c=p.now();a||n.leading!==!1||(a=c);var u=e-(c-a);return i=this,s=arguments,0>=u||u>e?(clearTimeout(o),o=null,a=c,r=t.apply(i,s),o||(i=s=null)):o||n.trailing===!1||(o=setTimeout(l,u)),r}},p.debounce=function(t,e,n){var i,s,r,o,a,l=function(){var c=p.now()-o;e>c&&c>0?i=setTimeout(l,e-c):(i=null,n||(a=t.apply(r,s),i||(r=s=null)))};return function(){r=this,s=arguments,o=p.now();var c=n&&!i;return i||(i=setTimeout(l,e)),c&&(a=t.apply(r,s),r=s=null),a}},p.wrap=function(t,e){return p.partial(e,t)},p.negate=function(t){return function(){return!t.apply(this,arguments)}},p.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,i=t[e].apply(this,arguments);n--;)i=t[n].call(this,i);return i}},p.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},p.before=function(t,e){var n;return function(){return--t>0?n=e.apply(this,arguments):e=null,n}},p.once=p.partial(p.before,2),p.keys=function(t){if(!p.isObject(t))return[];if(h)return h(t);var e=[];for(var n in t)p.has(t,n)&&e.push(n);return e},p.values=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),s=0;n>s;s++)i[s]=t[e[s]];return i},p.pairs=function(t){for(var e=p.keys(t),n=e.length,i=Array(n),s=0;n>s;s++)i[s]=[e[s],t[e[s]]];return i},p.invert=function(t){for(var e={},n=p.keys(t),i=0,s=n.length;s>i;i++)e[t[n[i]]]=n[i];return e},p.functions=p.methods=function(t){var e=[];for(var n in t)p.isFunction(t[n])&&e.push(n);return e.sort()},p.extend=function(t){if(!p.isObject(t))return t;for(var e,n,i=1,s=arguments.length;s>i;i++){e=arguments[i];for(n in e)c.call(e,n)&&(t[n]=e[n])}return t},p.pick=function(t,e,n){var i={},s;if(null==t)return i;if(p.isFunction(e)){e=f(e,n);for(s in t){var r=t[s];e(r,s,t)&&(i[s]=r)}}else{var l=a.apply([],o.call(arguments,1));t=new Object(t);for(var c=0,u=l.length;u>c;c++)s=l[c],s in t&&(i[s]=t[s])}return i},p.omit=function(t,e,n){if(p.isFunction(e))e=p.negate(e);else{var i=p.map(a.apply([],o.call(arguments,1)),String);e=function(t,e){return!p.contains(i,e)}}return p.pick(t,e,n)},p.defaults=function(t){if(!p.isObject(t))return t;for(var e=1,n=arguments.length;n>e;e++){var i=arguments[e];for(var s in i)void 0===t[s]&&(t[s]=i[s])}return t},p.clone=function(t){return p.isObject(t)?p.isArray(t)?t.slice():p.extend({},t):t},p.tap=function(t,e){return e(t),t};var y=function(t,e,n,i){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof p&&(t=t._wrapped),e instanceof p&&(e=e._wrapped);var s=l.call(t);if(s!==l.call(e))return!1;switch(s){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]===t)return i[r]===e;var o=t.constructor,a=e.constructor;if(o!==a&&"constructor"in t&&"constructor"in e&&!(p.isFunction(o)&&o instanceof o&&p.isFunction(a)&&a instanceof a))return!1;n.push(t),i.push(e);var c,u;if("[object Array]"===s){if(c=t.length,u=c===e.length)for(;c--&&(u=y(t[c],e[c],n,i)););}else{var h=p.keys(t),d;if(c=h.length,u=p.keys(e).length===c)for(;c--&&(d=h[c],u=p.has(e,d)&&y(t[d],e[d],n,i)););}return n.pop(),i.pop(),u};p.isEqual=function(t,e){return y(t,e,[],[])},p.isEmpty=function(t){if(null==t)return!0;if(p.isArray(t)||p.isString(t)||p.isArguments(t))return 0===t.length;for(var e in t)if(p.has(t,e))return!1;return!0},p.isElement=function(t){return!(!t||1!==t.nodeType)},p.isArray=u||function(t){return"[object Array]"===l.call(t)},p.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){p["is"+t]=function(e){return l.call(e)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(t){return p.has(t,"callee")}),"function"!=typeof/./&&(p.isFunction=function(t){return"function"==typeof t||!1}),p.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},p.isNaN=function(t){return p.isNumber(t)&&t!==+t},p.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===l.call(t)},p.isNull=function(t){return null===t},p.isUndefined=function(t){return void 0===t},p.has=function(t,e){return null!=t&&c.call(t,e)},p.noConflict=function(){return t._=e,this},p.identity=function(t){return t},p.constant=function(t){return function(){return t}},p.noop=function(){},p.property=function(t){return function(e){return e[t]}},p.matches=function(t){var e=p.pairs(t),n=e.length;return function(t){if(null==t)return!n;t=new Object(t);for(var i=0;n>i;i++){var s=e[i],r=s[0];if(s[1]!==t[r]||!(r in t))return!1}return!0}},p.times=function(t,e,n){var i=Array(Math.max(0,t));e=f(e,n,1);for(var s=0;t>s;s++)i[s]=e(s);return i},p.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},x=p.invert(w),C=function(t){var e=function(e){return t[e]},n="(?:"+p.keys(t).join("|")+")",i=RegExp(n),s=RegExp(n,"g");return function(t){return t=null==t?"":""+t,i.test(t)?t.replace(s,e):t}};p.escape=C(w),p.unescape=C(x),p.result=function(t,e){if(null==t)return void 0;var n=t[e];return p.isFunction(n)?t[e]():n};var k=0;p.uniqueId=function(t){var e=++k+"";return t?t+e:e},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var _=/(.)^/,S={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\u2028|\u2029/g,T=function(t){return"\\"+S[t]};p.template=function(t,e,n){!e&&n&&(e=n),e=p.defaults({},e,p.templateSettings);var i=RegExp([(e.escape||_).source,(e.interpolate||_).source,(e.evaluate||_).source].join("|")+"|$","g"),s=0,r="__p+='";t.replace(i,function(e,n,i,o,a){return r+=t.slice(s,a).replace(E,T),s=a+e.length,n?r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?r+="'+\n((__t=("+i+"))==null?'':__t)+\n'":o&&(r+="';\n"+o+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var o=new Function(e.variable||"obj","_",r)}catch(a){throw a.source=r,a}var l=function(t){return o.call(this,t,p)},c=e.variable||"obj";return l.source="function("+c+"){\n"+r+"}",l},p.chain=function(t){var e=p(t);return e._chain=!0,e};var A=function(t){return this._chain?p(t).chain():t};p.mixin=function(t){p.each(p.functions(t),function(e){var n=p[e]=t[e];p.prototype[e]=function(){var t=[this._wrapped];return r.apply(t,arguments),A.call(this,n.apply(p,t))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];p.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],A.call(this,n)}}),p.each(["concat","join","slice"],function(t){var e=n[t];p.prototype[t]=function(){return A.call(this,e.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}).call(this),function(){var t=this,e=t.Backbone,n=Array.prototype.slice,i=Array.prototype.splice,s;s="undefined"!=typeof exports?exports:t.Backbone={},s.VERSION="0.9.2";var r=t._;r||"undefined"==typeof require||(r=require("underscore"));var $=t.jQuery||t.Zepto||t.ender;s.setDomLibrary=function(t){$=t},s.noConflict=function(){return t.Backbone=e,this},s.emulateHTTP=!1,s.emulateJSON=!1;var o=/\s+/,a=s.Events={on:function(t,e,n){var i,s,r,a,l;if(!e)return this;for(t=t.split(o),i=this._callbacks||(this._callbacks={});s=t.shift();)l=i[s],r=l?l.tail:{},r.next=a={},r.context=n,r.callback=e,i[s]={tail:a,next:l?l.next:r};return this},off:function(t,e,n){var i,s,a,l,c,u;if(s=this._callbacks){if(!(t||e||n))return delete this._callbacks,this;for(t=t?t.split(o):r.keys(s);i=t.shift();)if(a=s[i],delete s[i],a&&(e||n))for(l=a.tail;(a=a.next)!==l;)c=a.callback,u=a.context,(e&&c!==e||n&&u!==n)&&this.on(i,c,u);return this}},trigger:function(t){var e,i,s,r,a,l,c;if(!(s=this._callbacks))return this;for(l=s.all,t=t.split(o),c=n.call(arguments,1);e=t.shift();){if(i=s[e])for(r=i.tail;(i=i.next)!==r;)i.callback.apply(i.context||this,c);if(i=l)for(r=i.tail,a=[e].concat(c);(i=i.next)!==r;)i.callback.apply(i.context||this,a)}return this}};a.bind=a.on,a.unbind=a.off;var l=s.Model=function(t,e){var n;t||(t={}),e&&e.parse&&(t=this.parse(t)),(n=S(this,"defaults"))&&(t=r.extend({},n,t)),e&&e.collection&&(this.collection=e.collection),this.attributes={},this._escapedAttributes={},this.cid=r.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(t,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=r.clone(this.attributes),this.initialize.apply(this,arguments)};r.extend(l.prototype,a,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return r.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){var e;if(e=this._escapedAttributes[t])return e;var n=this.get(t);return this._escapedAttributes[t]=r.escape(null==n?"":""+n)},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,s,o;if(r.isObject(t)||null==t?(i=t,n=e):(i={},i[t]=e),n||(n={}),!i)return this;if(i instanceof l&&(i=i.attributes),n.unset)for(s in i)i[s]=void 0;if(!this._validate(i,n))return!1;this.idAttribute in i&&(this.id=i[this.idAttribute]);var a=n.changes={},c=this.attributes,u=this._escapedAttributes,h=this._previousAttributes||{};for(s in i)o=i[s],(!r.isEqual(c[s],o)||n.unset&&r.has(c,s))&&(delete u[s],(n.silent?this._silent:a)[s]=!0),n.unset?delete c[s]:c[s]=o,r.isEqual(h[s],o)&&r.has(c,s)==r.has(h,s)?(delete this.changed[s],delete this._pending[s]):(this.changed[s]=o,n.silent||(this._pending[s]=!0));return n.silent||this.change(n),this},unset:function(t,e){return(e||(e={})).unset=!0,this.set(t,null,e)},clear:function(t){return(t||(t={})).unset=!0,this.set(r.clone(this.attributes),t)},fetch:function(t){t=t?r.clone(t):{};var e=this,n=t.success;return t.success=function(i,s,r){return e.set(e.parse(i,r),t)?void(n&&n(e,i)):!1},t.error=s.wrapError(t.error,e,t),(this.sync||s.sync).call(this,"read",this,t)},save:function(t,e,n){var i,o;if(r.isObject(t)||null==t?(i=t,n=e):(i={},i[t]=e),n=n?r.clone(n):{},n.wait){if(!this._validate(i,n))return!1;o=r.clone(this.attributes)}var a=r.extend({},n,{silent:!0});if(i&&!this.set(i,n.wait?a:n))return!1;var l=this,c=n.success;n.success=function(t,e,s){var o=l.parse(t,s);return n.wait&&(delete n.wait,o=r.extend(i||{},o)),l.set(o,n)?void(c?c(l,t):l.trigger("sync",l,t,n)):!1},n.error=s.wrapError(n.error,l,n);var u=this.isNew()?"create":"update",h=(this.sync||s.sync).call(this,u,this,n);return n.wait&&this.set(o,a),h},destroy:function(t){t=t?r.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(this.isNew())return i(),!1;t.success=function(s){t.wait&&i(),n?n(e,s):e.trigger("sync",e,s,t)},t.error=s.wrapError(t.error,e,t);var o=(this.sync||s.sync).call(this,"delete",this,t);return t.wait||i(),o},url:function(){var t=S(this,"urlRoot")||S(this.collection,"url")||E();return this.isNew()?t:t+("/"==t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(t){t||(t={});var e=this._changing;this._changing=!0;for(var n in this._silent)this._pending[n]=!0;var i=r.extend({},t.changes,this._silent);this._silent={};for(var n in i)this.trigger("change:"+n,this,this.get(n),t);if(e)return this;for(;!r.isEmpty(this._pending);){this._pending={},this.trigger("change",this,t);for(var n in this.changed)this._pending[n]||this._silent[n]||delete this.changed[n];this._previousAttributes=r.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(t){return arguments.length?r.has(this.changed,t):!r.isEmpty(this.changed)},changedAttributes:function(t){if(!t)return this.hasChanged()?r.clone(this.changed):!1;var e,n=!1,i=this._previousAttributes;for(var s in t)r.isEqual(i[s],e=t[s])||((n||(n={}))[s]=e);return n},previous:function(t){return arguments.length&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(t,e){if(e.silent||!this.validate)return!0;t=r.extend({},this.attributes,t);var n=this.validate(t,e);return n?(e&&e.error?e.error(this,n,e):this.trigger("error",this,n,e),!1):!0}});var c=s.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,{silent:!0,parse:e.parse})};r.extend(c.prototype,a,{model:l,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){var n,s,o,a,l,c,u={},h={},d=[];for(e||(e={}),t=r.isArray(t)?t.slice():[t],n=0,o=t.length;o>n;n++){if(!(a=t[n]=this._prepareModel(t[n],e)))throw new Error("Can't add an invalid model to a collection");l=a.cid,c=a.id,u[l]||this._byCid[l]||null!=c&&(h[c]||this._byId[c])?d.push(n):u[l]=h[c]=a}for(n=d.length;n--;)t.splice(d[n],1);for(n=0,o=t.length;o>n;n++)(a=t[n]).on("all",this._onModelEvent,this),this._byCid[a.cid]=a,null!=a.id&&(this._byId[a.id]=a);if(this.length+=o,s=null!=e.at?e.at:this.models.length,i.apply(this.models,[s,0].concat(t)),this.comparator&&this.sort({silent:!0}),e.silent)return this;for(n=0,o=this.models.length;o>n;n++)u[(a=this.models[n]).cid]&&(e.index=n,a.trigger("add",a,this,e));return this},remove:function(t,e){var n,i,s,o;for(e||(e={}),t=r.isArray(t)?t.slice():[t],n=0,i=t.length;i>n;n++)o=this.getByCid(t[n])||this.get(t[n]),o&&(delete this._byId[o.id],delete this._byCid[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,e.silent||(e.index=s,o.trigger("remove",o,this,e)),this._removeReference(o));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,e),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,r.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t]},getByCid:function(t){return t&&this._byCid[t.cid||t]},at:function(t){return this.models[t]},where:function(t){return r.isEmpty(t)?[]:this.filter(function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},sort:function(t){if(t||(t={}),!this.comparator)throw new Error("Cannot sort a set without a comparator");var e=r.bind(this.comparator,this);return 1==this.comparator.length?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("reset",this,t),this},pluck:function(t){return r.map(this.models,function(e){return e.get(t)})},reset:function(t,e){t||(t=[]),e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return this._reset(),this.add(t,r.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(t){t=t?r.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i,s,r){e[t.add?"add":"reset"](e.parse(i,r),t),n&&n(e,i)},t.error=s.wrapError(t.error,e,t),(this.sync||s.sync).call(this,"read",this,t)},create:function(t,e){var n=this;if(e=e?r.clone(e):{},t=this._prepareModel(t,e),!t)return!1;e.wait||n.add(t,e);var i=e.success;return e.success=function(s,r,o){e.wait&&n.add(s,e),i?i(s,r):s.trigger("sync",t,r,e)},t.save(null,e),t},parse:function(t,e){return t},chain:function(){return r(this.models).chain()},_reset:function(t){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(t,e){if(e||(e={}),t instanceof l)t.collection||(t.collection=this);else{var n=t;e.collection=this,t=new this.model(n,e),t._validate(t.attributes,e)||(t=!1)}return t},_removeReference:function(t){this==t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!=t&&"remove"!=t||n==this)&&("destroy"==t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],this._byId[e.id]=e),this.trigger.apply(this,arguments))}});var u=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];r.each(u,function(t){c.prototype[t]=function(){return r[t].apply(r,[this.models].concat(r.toArray(arguments)))}});var h=s.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},d=/:\w+/g,p=/\*\w+/g,f=/[-[\]{}()+?.,\\^$|#\s]/g;r.extend(h.prototype,a,{initialize:function(){},route:function(t,e,n){return s.history||(s.history=new g),r.isRegExp(t)||(t=this._routeToRegExp(t)),n||(n=this[e]),s.history.route(t,r.bind(function(i){var r=this._extractParameters(t,i);n&&n.apply(this,r),this.trigger.apply(this,["route:"+e].concat(r)),s.history.trigger("route",this,e,r)},this)),this},navigate:function(t,e){s.history.navigate(t,e)},_bindRoutes:function(){if(this.routes){var t=[];for(var e in this.routes)t.unshift([e,this.routes[e]]);for(var n=0,i=t.length;i>n;n++)this.route(t[n][0],t[n][1],this[t[n][1]])}},_routeToRegExp:function(t){return t=t.replace(f,"\\$&").replace(d,"([^/]+)").replace(p,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var g=s.History=function(){this.handlers=[],r.bindAll(this,"checkUrl")},v=/^[#\/]/,m=/msie [\w.]+/;g.started=!1,r.extend(g.prototype,a,{interval:50,getHash:function(t){var e=t?t.location:window.location,n=e.href.match(/#(.*)$/);return n?n[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||e){t=window.location.pathname;var n=window.location.search;n&&(t+=n)}else t=this.getHash();return t.indexOf(this.options.root)||(t=t.substr(this.options.root.length)),t.replace(v,"")},start:function(t){if(g.started)throw new Error("Backbone.history has already been started");g.started=!0,this.options=r.extend({},{root:"/"},this.options,t),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var e=this.getFragment(),n=document.documentMode,i=m.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);i&&(this.iframe=$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(e)),this._hasPushState?$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=e;var s=window.location,o=s.pathname==this.options.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(v,""),window.history.replaceState({},document.title,s.protocol+"//"+s.host+this.options.root+this.fragment)),this.options.silent?void 0:this.loadUrl())},stop:function(){$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),g.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e==this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e==this.fragment?!1:(this.iframe&&this.navigate(e),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=r.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!g.started)return!1;e&&e!==!0||(e={trigger:e});var n=(t||"").replace(v,"");this.fragment!=n&&(this._hasPushState?(0!=n.indexOf(this.options.root)&&(n=this.options.root+n),this.fragment=n,window.history[e.replace?"replaceState":"pushState"]({},document.title,n)):this._wantsHashChange?(this.fragment=n,this._updateHash(window.location,n,e.replace),this.iframe&&n!=this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,n,e.replace))):window.location.assign(this.options.root+t),e.trigger&&this.loadUrl(t))},_updateHash:function(t,e,n){n?t.replace(t.toString().replace(/(javascript:|#).*$/,"")+"#"+e):t.hash=e}});var b=s.View=function(t){this.cid=r.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},y=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName"];r.extend(b.prototype,a,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(t,e,n){var i=document.createElement(t);return e&&$(i).attr(e),n&&$(i).html(n),i},setElement:function(t,e){return this.$el&&this.undelegateEvents(),this.$el=t instanceof $?t:$(t),this.el=this.$el[0],e!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(t||(t=S(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(r.isFunction(n)||(n=this[t[e]]),!n)throw new Error('Method "'+t[e]+'" does not exist');var i=e.match(y),s=i[1],o=i[2];n=r.bind(n,this),s+=".delegateEvents"+this.cid,""===o?this.$el.bind(s,n):this.$el.delegate(o,s,n)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=r.extend({},this.options,t));for(var e=0,n=w.length;n>e;e++){var i=w[e];t[i]&&(this[i]=t[i])}this.options=t},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var t=S(this,"attributes")||{};this.id&&(t.id=this.id),this.className&&(t["class"]=this.className),this.setElement(this.make(this.tagName,t),!1)}}});var x=function(t,e){var n=_(this,t,e);return n.extend=this.extend,n};l.extend=c.extend=h.extend=b.extend=x;var C={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};s.sync=function(t,e,n){var i=C[t];n||(n={});var o={type:i,dataType:"json"};return n.url||(o.url=S(e,"url")||E()),n.data||!e||"create"!=t&&"update"!=t||(o.contentType="application/json",o.data=JSON.stringify(e.toJSON())),s.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),s.emulateHTTP&&("PUT"===i||"DELETE"===i)&&(s.emulateJSON&&(o.data._method=i),o.type="POST",o.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",i)}),"GET"===o.type||s.emulateJSON||(o.processData=!1),$.ajax(r.extend(o,n))},s.wrapError=function(t,e,n){return function(i,s){s=i===e?s:i,t?t(e,s,n):e.trigger("error",e,s,n)}};var k=function(){},_=function(t,e,n){var i;return i=e&&e.hasOwnProperty("constructor")?e.constructor:function(){t.apply(this,arguments)},r.extend(i,t),k.prototype=t.prototype,i.prototype=new k,e&&r.extend(i.prototype,e),n&&r.extend(i,n),i.prototype.constructor=i,i.__super__=t.prototype,i},S=function(t,e){return t&&t[e]?r.isFunction(t[e])?t[e]():t[e]:null},E=function(){throw new Error('A "url" property or function must be specified')}}.call(this),function(){var t,e,n,i,s,r,o=[].slice;n=function(t){var e,i;return!_.isObject(t)||_.isFunction(t)?t:t instanceof Backbone.Collection||t instanceof Backbone.Model?t:_.isDate(t)?new Date(t.getTime()):_.isRegExp(t)?new RegExp(t.source,t.toString().replace(/.*\//,"")):(i=_.isArray(t||_.isArguments(t)),e=function(t,e,s){return i?t.push(n(e)):t[s]=n(e),t
},_.reduce(t,e,i?[]:{}))},r=function(t){return null==t?!1:!(t.prototype!=={}.prototype&&t.prototype!==Object.prototype||!_.isObject(t)||_.isArray(t)||_.isFunction(t)||_.isDate(t)||_.isRegExp(t)||_.isArguments(t))},e=function(t){return _.filter(_.keys(t),function(e){return r(t[e])})},t=function(t){return _.filter(_.keys(t),function(e){return _.isArray(t[e])})},s=function(n,i,r){var o,a,l,c,u,h,d,p,f,g;if(null==r&&(r=20),0>=r)return console.warn("_.deepExtend(): Maximum depth of recursion hit."),_.extend(n,i);for(h=_.intersection(e(n),e(i)),a=function(t){return i[t]=s(n[t],i[t],r-1)},d=0,f=h.length;f>d;d++)u=h[d],a(u);for(c=_.intersection(t(n),t(i)),o=function(t){return i[t]=_.union(n[t],i[t])},p=0,g=c.length;g>p;p++)l=c[p],o(l);return _.extend(n,i)},i=function(){var t,e,i,r;if(i=2<=arguments.length?o.call(arguments,0,r=arguments.length-1):(r=0,[]),e=arguments[r++],_.isNumber(e)||(i.push(e),e=20),i.length<=1)return i[0];if(0>=e)return _.extend.apply(this,i);for(t=i.shift();i.length>0;)t=s(t,n(i.shift()),e);return t},_.mixin({deepClone:n,isBasicObject:r,basicObjects:e,arrays:t,deepExtend:i})}.call(this),function(t){"function"==typeof define&&define.amd?define(["underscore","backbone"],t):t(_,Backbone)}(function(t,e){function n(e){var i={},s=o.keyPathSeparator;for(var r in e){var a=e[r];if(a&&a.constructor===Object&&!t.isEmpty(a)){var l=n(a);for(var c in l){var u=l[c];i[r+s+c]=u}}else i[r]=a}return i}function i(e,n,i){for(var s=o.keyPathSeparator,r=n.split(s),a=e,l=0,c=r.length;c>l;l++){if(i&&!t.has(a,r[l]))return!1;if(a=a[r[l]],null==a&&c-1>l&&(a={}),"undefined"==typeof a)return i?!0:a}return i?!0:a}function s(e,n,i,s){s=s||{};for(var r=o.keyPathSeparator,a=n.split(r),l=e,c=0,u=a.length;u>c&&void 0!==l;c++){var h=a[c];c===u-1?s.unset?delete l[h]:l[h]=i:("undefined"!=typeof l[h]&&t.isObject(l[h])||(l[h]={}),l=l[h])}}function r(t,e){s(t,e,null,{unset:!0})}var o=e.Model.extend({constructor:function(e,n){var i,s=e||{};this.cid=t.uniqueId("c"),this.attributes={},n&&n.collection&&(this.collection=n.collection),n&&n.parse&&(s=this.parse(s,n)||{}),(i=t.result(this,"defaults"))&&(s=t.deepExtend({},i,s)),this.set(s,n),this.changed={},this.initialize.apply(this,arguments)},toJSON:function(e){return t.deepClone(this.attributes)},get:function(t){return i(this.attributes,t)},set:function(e,a,l){var c,u,h,d,p,f,g,v;if(null==e)return this;if("object"==typeof e?(u=e,l=a||{}):(u={})[e]=a,l||(l={}),!this._validate(u,l))return!1;h=l.unset,p=l.silent,d=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=t.deepClone(this.attributes),this.changed={}),v=this.attributes,g=this._previousAttributes,this.idAttribute in u&&(this.id=u[this.idAttribute]),u=n(u);for(c in u)a=u[c],t.isEqual(i(v,c),a)||d.push(c),t.isEqual(i(g,c),a)?r(this.changed,c):s(this.changed,c,a),h?r(v,c):s(v,c,a);if(!p){d.length&&(this._pending=!0);for(var m=o.keyPathSeparator,b=0,y=d.length;y>b;b++){var e=d[b];this.trigger("change:"+e,this,i(v,e),l);for(var w=e.split(m),x=w.length-1;x>0;x--){var C=t.first(w,x).join(m),k=C+m+"*";this.trigger("change:"+k,this,i(v,C),l)}}}if(f)return this;if(!p)for(;this._pending;)this._pending=!1,this.trigger("change",this,l);return this._pending=!1,this._changing=!1,this},clear:function(e){var i={},s=n(this.attributes);for(var r in s)i[r]=void 0;return this.set(i,t.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!t.isEmpty(this.changed):void 0!==i(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n(this.changed):!1;var i=this._changing?this._previousAttributes:this.attributes;e=n(e),i=n(i);var s,r=!1;for(var o in e)t.isEqual(i[o],s=e[o])||((r||(r={}))[o]=s);return r},previous:function(t){return null!=t&&this._previousAttributes?i(this._previousAttributes,t):null},previousAttributes:function(){return t.deepClone(this._previousAttributes)}});return o.keyPathSeparator=".",e.DeepModel=o,"undefined"!=typeof module&&(module.exports=o),e});var __slice=[].slice,__hasProp={}.hasOwnProperty,__indexOf=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};if(function(t){return t("backbone-query",function(t,e){var n,i,s,r,o,a,l,c,u,h,d,p,f,g,v,m,b,y,w;return w=t("underscore"),n=t("backbone"),s=function(t,e){var n,i,s,r;for(r=[],i=0,s=t.length;s>i;i++)n=t[i],e(n)&&r.push(n);return r},g=function(t,e){var n,i,s,r;for(r=[],i=0,s=t.length;s>i;i++)n=t[i],e(n)||r.push(n);return r},i=function(t,e){var n,i,s;for(i=0,s=t.length;s>i;i++)if(n=t[i],e(n))return!0;return!1},c=function(){var t,e,n,i,s;for(t=1<=arguments.length?__slice.call(arguments,0):[],i={},e=i;t.length;)n=t.shift(),s=1===t.length?t.shift():{},e=e[n]=s;return i},a=function(t){return w.isRegExp(t)?"$regex":w.isDate(t)?"$date":w.isObject(t)&&!w.isArray(t)?"object":w.isArray(t)?"array":w.isString(t)?"string":w.isNumber(t)?"number":w.isBoolean(t)?"boolean":w.isFunction(t)?"function":!1},d=function(t){var e,n,i,s,r,o,l,u,p,f,g,v,m;for(o=w.isArray(t)?t:function(){var n;n=[];for(e in t)__hasProp.call(t,e)&&(p=t[e],n.push(c(e,p)));return n}(),m=[],g=0,v=o.length;v>g;g++){r=o[g];for(e in r)if(__hasProp.call(r,e)){switch(l=r[e],n={key:e},i=a(l)){case"$regex":case"$date":n.type=i,n.value=l;break;case"object":if("$and"===e||"$or"===e||"$nor"===e||"$not"===e)n.value=d(l),n.type=e,n.key=null;else for(u in l)if(f=l[u],y(u,f))switch(n.type=u,u){case"$elemMatch":case"$relationMatch":n.value=h(f);break;case"$computed":s=c(e,f),n.value=d(s);break;default:n.value=f}break;default:n.type="$equal",n.value=l}"$equal"!==n.type||"object"!==i&&"array"!==i||(n.type="$oEqual")}m.push(n)}return m},y=function(t,e){switch(t){case"$in":case"$nin":case"$all":case"$any":return w(e).isArray();case"$size":return w(e).isNumber();case"$regex":return w(e).isRegExp();case"$like":case"$likeI":return w(e).isString();case"$between":return w(e).isArray()&&2===e.length;case"$cb":return w(e).isFunction();default:return!0}},b=function(t,e){switch(t){case"$like":case"$likeI":case"$regex":return w(e).isString();case"$contains":case"$all":case"$any":case"$elemMatch":return w(e).isArray();case"$size":return w(e).isArray()||w(e).isString();case"$in":case"$nin":return null!=e;case"$relationMatch":return null!=e&&e.models;default:return!0}},p=function(t,e,n,s,r){switch(t){case"$equal":return w(n).isArray()?__indexOf.call(n,e)>=0:n===e;break;case"$oEqual":return w(n).isEqual(e);case"$contains":return __indexOf.call(n,e)>=0;case"$ne":return n!==e;case"$lt":return e>n;case"$gt":return n>e;case"$lte":return e>=n;case"$gte":return n>=e;case"$between":return e[0]<n&&n<e[1];case"$in":return __indexOf.call(e,n)>=0;case"$nin":return __indexOf.call(e,n)<0;case"$all":return w(e).all(function(t){return __indexOf.call(n,t)>=0});case"$any":return w(n).any(function(t){return __indexOf.call(e,t)>=0});case"$size":return n.length===e;case"$exists":case"$has":return null!=n===e;case"$like":return-1!==n.indexOf(e);case"$likeI":return-1!==n.toLowerCase().indexOf(e.toLowerCase());case"$regex":return e.test(n);case"$cb":return e.call(s,n);case"$elemMatch":return v(n,e,"elemMatch").length>0;case"$relationMatch":return v(n.models,e,"relationMatch").length>0;case"$computed":return l([s],e,!1,i,"computed");case"$and":case"$or":case"$nor":case"$not":return 1===f[t]([s],e).length;default:return!1}},l=function(t,e,n,i,s){return null==s&&(s=!1),i(t,function(t){var i,r,o,a,l;for(a=0,l=e.length;l>a;a++)if(r=e[a],i=function(){switch(s){case"elemMatch":return t[r.key];case"computed":return t[r.key]();default:return t.get(r.key)}}(),o=b(r.type,i),o&&(o=p(r.type,r.value,i,t,r.key)),n===o)return n;return!n})},f={$and:function(t,e,n){return l(t,e,!1,s,n)},$or:function(t,e,n){return l(t,e,!0,s,n)},$nor:function(t,e,n){return l(t,e,!0,g,n)},$not:function(t,e,n){return l(t,e,!1,g,n)}},h=function(t){var e,n,i,s,r,o;if(s=w(t).keys(),e=["$and","$not","$or","$nor"],n=w.intersection(e,s),0===n.length)return[{type:"$and",parsedQuery:d(t)}];if(n.length!==s.length){__indexOf.call(n,"$and")<0&&(t.$and={},n.unshift("$and"));for(i in t)__hasProp.call(t,i)&&(o=t[i],__indexOf.call(e,i)<0&&(t.$and[i]=o,delete t[i]))}return function(){var e,i,s;for(s=[],e=0,i=n.length;i>e;e++)r=n[e],s.push({type:r,parsedQuery:d(t[r])});return s}()},v=function(t,e,n){var i;return n||(e=h(e)),i=function(t,e){return f[e.type](t,e.parsedQuery,n)},w.reduce(e,i,t)},r=function(t,e,n){var i,s,r,a;return r=JSON.stringify(e),i=null!=(a=t._queryCache)?a:t._queryCache={},s=i[r],s||(s=o(t,e,n),i[r]=s),s},o=function(t,e,n){var i;return i=v(t.models,e),n.sortBy&&(i=m(i,n)),i},m=function(t,e){return w(e.sortBy).isString()?t=w(t).sortBy(function(t){return t.get(e.sortBy)}):w(e.sortBy).isFunction()&&(t=w(t).sortBy(e.sortBy)),"desc"===e.order&&(t=t.reverse()),t},u=function(t,e){var n,i,s,r;return s=e.offset?e.offset:e.page?(e.page-1)*e.limit:0,n=s+e.limit,i=t.slice(s,n),e.pager&&w.isFunction(e.pager)&&(r=Math.ceil(t.length/e.limit),e.pager(r,i)),i},n.QueryCollection=n.Collection.extend({query:function(t,e){var n;return null==e&&(e={}),n=e.cache?r(this,t,e):o(this,t,e),e.limit&&(n=u(n,e)),n},findOne:function(t){return this.query(t)[0]},whereBy:function(t,e){return null==e&&(e={}),new this.constructor(this.query(t,e))},resetQueryCache:function(){return this._queryCache={}}}),e.QueryCollection=n.QueryCollection})}.call(this,"function"==typeof define&&define.amd?define:function(t,e){"undefined"!=typeof exports?e(function(t){return require(t)},exports):e(function(t){return this["underscore"===t?"_":"Backbone"]},{})}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function($){"use strict";function t(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}$.fn.emulateTransitionEnd=function(t){var e=!1,n=this;$(this).one("bsTransitionEnd",function(){e=!0});var i=function(){e||$(n).trigger($.support.transition.end)};return setTimeout(i,t),this},$(function(){$.support.transition=t(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(t){return $(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var e=$(this),i=e.data("bs.alert");i||e.data("bs.alert",i=new n(this)),"string"==typeof t&&i[t].call(e)})}var e='[data-dismiss="alert"]',n=function(t){$(t).on("click",e,this.close)};n.VERSION="3.2.0",n.prototype.close=function(t){function e(){s.detach().trigger("closed.bs.alert").remove()}var n=$(this),i=n.attr("data-target");i||(i=n.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var s=$(i);t&&t.preventDefault(),s.length||(s=n.hasClass("alert")?n:n.parent()),s.trigger(t=$.Event("close.bs.alert")),t.isDefaultPrevented()||(s.removeClass("in"),$.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",e).emulateTransitionEnd(150):e())};var i=$.fn.alert;$.fn.alert=t,$.fn.alert.Constructor=n,$.fn.alert.noConflict=function(){return $.fn.alert=i,this},$(document).on("click.bs.alert.data-api",e,n.prototype.close)}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.button"),s="object"==typeof t&&t;i||n.data("bs.button",i=new e(this,s)),"toggle"==t?i.toggle():t&&i.setState(t)})}var e=function(t,n){this.$element=$(t),this.options=$.extend({},e.DEFAULTS,n),this.isLoading=!1};e.VERSION="3.2.0",e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(t){var e="disabled",n=this.$element,i=n.is("input")?"val":"html",s=n.data();t+="Text",null==s.resetText&&n.data("resetText",n[i]()),n[i](null==s[t]?this.options[t]:s[t]),setTimeout($.proxy(function(){"loadingText"==t?(this.isLoading=!0,n.addClass(e).attr(e,e)):this.isLoading&&(this.isLoading=!1,n.removeClass(e).removeAttr(e))},this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var n=$.fn.button;$.fn.button=t,$.fn.button.Constructor=e,$.fn.button.noConflict=function(){return $.fn.button=n,this},$(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(e){var n=$(e.target);n.hasClass("btn")||(n=n.closest(".btn")),t.call(n,"toggle"),e.preventDefault()})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.carousel"),s=$.extend({},e.DEFAULTS,n.data(),"object"==typeof t&&t),r="string"==typeof t?t:s.slide;i||n.data("bs.carousel",i=new e(this,s)),"number"==typeof t?i.to(t):r?i[r]():s.interval&&i.pause().cycle()})}var e=function(t,e){this.$element=$(t).on("keydown.bs.carousel",$.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=e,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",$.proxy(this.pause,this)).on("mouseleave.bs.carousel",$.proxy(this.cycle,this))};e.VERSION="3.2.0",e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},e.prototype.keydown=function(t){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()},e.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval)),this},e.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},e.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",$(this.$items[t]))},e.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&$.support.transition&&(this.$element.trigger($.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){return this.sliding?void 0:this.slide("next")},e.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},e.prototype.slide=function(t,e){var n=this.$element.find(".item.active"),i=e||n[t](),s=this.interval,r="next"==t?"left":"right",o="next"==t?"first":"last",a=this;if(!i.length){if(!this.options.wrap)return;i=this.$element.find(".item")[o]()}if(i.hasClass("active"))return this.sliding=!1;var l=i[0],c=$.Event("slide.bs.carousel",{relatedTarget:l,direction:r});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,s&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=$(this.$indicators.children()[this.getItemIndex(i)]);u&&u.addClass("active")}var h=$.Event("slid.bs.carousel",{relatedTarget:l,direction:r});return $.support.transition&&this.$element.hasClass("slide")?(i.addClass(t),i[0].offsetWidth,n.addClass(r),i.addClass(r),n.one("bsTransitionEnd",function(){i.removeClass([t,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(h)},0)}).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger(h)),s&&this.cycle(),this}};var n=$.fn.carousel;$.fn.carousel=t,$.fn.carousel.Constructor=e,$.fn.carousel.noConflict=function(){return $.fn.carousel=n,this},$(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var n,i=$(this),s=$(i.attr("data-target")||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var r=$.extend({},s.data(),i.data()),o=i.attr("data-slide-to");o&&(r.interval=!1),t.call(s,r),o&&s.data("bs.carousel").to(o),e.preventDefault()}}),$(window).on("load",function(){$('[data-ride="carousel"]').each(function(){var e=$(this);t.call(e,e.data())})})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.collapse"),s=$.extend({},e.DEFAULTS,n.data(),"object"==typeof t&&t);!i&&s.toggle&&"show"==t&&(t=!t),i||n.data("bs.collapse",i=new e(this,s)),"string"==typeof t&&i[t]()})}var e=function(t,n){this.$element=$(t),this.options=$.extend({},e.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=$(this.options.parent)),this.options.toggle&&this.toggle()};e.VERSION="3.2.0",e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=$.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var i=n.data("bs.collapse");if(i&&i.transitioning)return;t.call(n,"hide"),i||n.data("bs.collapse",null)}var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[s](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!$.support.transition)return r.call(this);var o=$.camelCase(["scroll",s].join("-"));this.$element.one("bsTransitionEnd",$.proxy(r,this)).emulateTransitionEnd(350)[s](this.$element[0][o])}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=$.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var e=this.dimension();this.$element[e](this.$element[e]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return $.support.transition?void this.$element[e](0).one("bsTransitionEnd",$.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=$.fn.collapse;$.fn.collapse=t,$.fn.collapse.Constructor=e,$.fn.collapse.noConflict=function(){return $.fn.collapse=n,this},$(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(e){var n,i=$(this),s=i.attr("data-target")||e.preventDefault()||(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),r=$(s),o=r.data("bs.collapse"),a=o?"toggle":i.data(),l=i.attr("data-parent"),c=l&&$(l);o&&o.transitioning||(c&&c.find('[data-toggle="collapse"][data-parent="'+l+'"]').not(i).addClass("collapsed"),i[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),t.call(r,a)})}(jQuery),+function($){"use strict";function t(t){t&&3===t.which||($(i).remove(),$(s).each(function(){var n=e($(this)),i={relatedTarget:this};n.hasClass("open")&&(n.trigger(t=$.Event("hide.bs.dropdown",i)),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown",i))}))}function e(t){var e=t.attr("data-target");e||(e=t.attr("href"),e=e&&/#[A-Za-z]/.test(e)&&e.replace(/.*(?=#[^\s]*$)/,""));var n=e&&$(e);return n&&n.length?n:t.parent()}function n(t){return this.each(function(){var e=$(this),n=e.data("bs.dropdown");n||e.data("bs.dropdown",n=new r(this)),"string"==typeof t&&n[t].call(e)})}var i=".dropdown-backdrop",s='[data-toggle="dropdown"]',r=function(t){$(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.2.0",r.prototype.toggle=function(n){var i=$(this);if(!i.is(".disabled, :disabled")){var s=e(i),r=s.hasClass("open");if(t(),!r){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",t);var o={relatedTarget:this};if(s.trigger(n=$.Event("show.bs.dropdown",o)),n.isDefaultPrevented())return;i.trigger("focus"),s.toggleClass("open").trigger("shown.bs.dropdown",o)}return!1}},r.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=$(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var i=e(n),r=i.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&i.find(s).trigger("focus"),n.trigger("click");var o=" li:not(.divider):visible a",a=i.find('[role="menu"]'+o+', [role="listbox"]'+o);if(a.length){var l=a.index(a.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<a.length-1&&l++,~l||(l=0),a.eq(l).trigger("focus")}}}};var o=$.fn.dropdown;$.fn.dropdown=n,$.fn.dropdown.Constructor=r,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=o,this},$(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,r.prototype.toggle).on("keydown.bs.dropdown.data-api",s+', [role="menu"], [role="listbox"]',r.prototype.keydown)}(jQuery),+function($){"use strict";function t(t,n){return this.each(function(){var i=$(this),s=i.data("bs.modal"),r=$.extend({},e.DEFAULTS,i.data(),"object"==typeof t&&t);s||i.data("bs.modal",s=new e(this,r)),"string"==typeof t?s[t](n):r.show&&s.show(n)})}var e=function(t,e){this.options=e,this.$body=$(document.body),this.$element=$(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};e.VERSION="3.2.0",e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},e.prototype.show=function(t){var e=this,n=$.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var n=$.support.transition&&e.$element.hasClass("fade");e.$element.parent().length||e.$element.appendTo(e.$body),e.$element.show().scrollTop(0),n&&e.$element[0].offsetWidth,e.$element.addClass("in").attr("aria-hidden",!1),e.enforceFocus();var i=$.Event("shown.bs.modal",{relatedTarget:t});n?e.$element.find(".modal-dialog").one("bsTransitionEnd",function(){e.$element.trigger("focus").trigger(i)}).emulateTransitionEnd(300):e.$element.trigger("focus").trigger(i)}))},e.prototype.hide=function(t){t&&t.preventDefault(),t=$.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",$.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(t){var e=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=$.support.transition&&n;if(this.$backdrop=$('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;i?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(150):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){e.removeBackdrop(),t&&t()};$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(150):s()}else t&&t()},e.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},e.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",t+this.scrollbarWidth)},e.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},e.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=$.fn.modal;$.fn.modal=t,$.fn.modal.Constructor=e,$.fn.modal.noConflict=function(){return $.fn.modal=n,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var n=$(this),i=n.attr("href"),s=$(n.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),r=s.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(i)&&i},s.data(),n.data());n.is("a")&&e.preventDefault(),s.one("show.bs.modal",function(t){t.isDefaultPrevented()||s.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),t.call(s,r,this)})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.tooltip"),s="object"==typeof t&&t;(i||"destroy"!=t)&&(i||n.data("bs.tooltip",i=new e(this,s)),"string"==typeof t&&i[t]())})}var e=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};e.VERSION="3.2.0",e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},e.prototype.init=function(t,e,n){this.enabled=!0,this.type=t,this.$element=$(e),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&$(this.options.viewport.selector||this.options.viewport);for(var i=this.options.trigger.split(" "),s=i.length;s--;){var r=i[s];if("click"==r)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=r){var o="hover"==r?"mouseenter":"focusin",a="hover"==r?"mouseleave":"focusout";this.$element.on(o+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(t){return t=$.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},e.prototype.getDelegateOptions=function(){var t={},e=this.getDefaults();return this._options&&$.each(this._options,function(n,i){e[n]!=i&&(t[n]=i)}),t},e.prototype.enter=function(t){var e=t instanceof this.constructor?t:$(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),$(t.currentTarget).data("bs."+this.type,e)),clearTimeout(e.timeout),e.hoverState="in",e.options.delay&&e.options.delay.show?void(e.timeout=setTimeout(function(){"in"==e.hoverState&&e.show()},e.options.delay.show)):e.show()},e.prototype.leave=function(t){var e=t instanceof this.constructor?t:$(t.currentTarget).data("bs."+this.type);return e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),$(t.currentTarget).data("bs."+this.type,e)),clearTimeout(e.timeout),e.hoverState="out",e.options.delay&&e.options.delay.hide?void(e.timeout=setTimeout(function(){"out"==e.hoverState&&e.hide()},e.options.delay.hide)):e.hide()},e.prototype.show=function(){var t=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var e=$.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!e)return;var n=this,i=this.tip(),s=this.getUID(this.type);this.setContent(),i.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&i.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,a=o.test(r);a&&(r=r.replace(o,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var l=this.getPosition(),c=i[0].offsetWidth,u=i[0].offsetHeight;if(a){var h=r,d=this.$element.parent(),p=this.getPosition(d);r="bottom"==r&&l.top+l.height+u-p.scroll>p.height?"top":"top"==r&&l.top-p.scroll-u<0?"bottom":"right"==r&&l.right+c>p.width?"left":"left"==r&&l.left-c<p.left?"right":r,i.removeClass(h).addClass(r)}var f=this.getCalculatedOffset(r,l,c,u);this.applyPlacement(f,r);var g=function(){n.$element.trigger("shown.bs."+n.type),n.hoverState=null};$.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},e.prototype.applyPlacement=function(t,e){var n=this.tip(),i=n[0].offsetWidth,s=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),o=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(o)&&(o=0),t.top=t.top+r,t.left=t.left+o,$.offset.setOffset(n[0],$.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},t),0),n.addClass("in");var a=n[0].offsetWidth,l=n[0].offsetHeight;"top"==e&&l!=s&&(t.top=t.top+s-l);var c=this.getViewportAdjustedDelta(e,t,a,l);c.left?t.left+=c.left:t.top+=c.top;var u=c.left?2*c.left-i+a:2*c.top-s+l,h=c.left?"left":"top",d=c.left?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(u,n[0][d],h)},e.prototype.replaceArrow=function(t,e,n){this.arrow().css(n,t?50*(1-t/e)+"%":"")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(){function t(){"in"!=e.hoverState&&n.detach(),e.$element.trigger("hidden.bs."+e.type)}var e=this,n=this.tip(),i=$.Event("hide.bs."+this.type);return this.$element.removeAttr("aria-describedby"),this.$element.trigger(i),i.isDefaultPrevented()?void 0:(n.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?n.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this)},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(t){t=t||this.$element;var e=t[0],n="BODY"==e.tagName;return $.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:n?$(window).width():t.outerWidth(),height:n?$(window).height():t.outerHeight()},n?{top:0,left:0}:t.offset())},e.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},e.prototype.getViewportAdjustedDelta=function(t,e,n,i){var s={top:0,left:0};
if(!this.$viewport)return s;var r=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-r-o.scroll,l=e.top+r-o.scroll+i;a<o.top?s.top=o.top-a:l>o.top+o.height&&(s.top=o.top+o.height-l)}else{var c=e.left-r,u=e.left+r+n;c<o.left?s.left=o.left-c:u>o.width&&(s.left=o.left+o.width-u)}return s},e.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},e.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},e.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(t){var e=this;t&&(e=$(t.currentTarget).data("bs."+this.type),e||(e=new this.constructor(t.currentTarget,this.getDelegateOptions()),$(t.currentTarget).data("bs."+this.type,e))),e.tip().hasClass("in")?e.leave(e):e.enter(e)},e.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var n=$.fn.tooltip;$.fn.tooltip=t,$.fn.tooltip.Constructor=e,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=n,this}}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.popover"),s="object"==typeof t&&t;(i||"destroy"!=t)&&(i||n.data("bs.popover",i=new e(this,s)),"string"==typeof t&&i[t]())})}var e=function(t,e){this.init("popover",t,e)};if(!$.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.2.0",e.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=$.extend({},$.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").empty()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},e.prototype.tip=function(){return this.$tip||(this.$tip=$(this.options.template)),this.$tip};var n=$.fn.popover;$.fn.popover=t,$.fn.popover.Constructor=e,$.fn.popover.noConflict=function(){return $.fn.popover=n,this}}(jQuery),+function($){"use strict";function t(e,n){var i=$.proxy(this.process,this);this.$body=$("body"),this.$scrollElement=$($(e).is("body")?window:e),this.options=$.extend({},t.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",i),this.refresh(),this.process()}function e(e){return this.each(function(){var n=$(this),i=n.data("bs.scrollspy"),s="object"==typeof e&&e;i||n.data("bs.scrollspy",i=new t(this,s)),"string"==typeof e&&i[e]()})}t.VERSION="3.2.0",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",e=0;$.isWindow(this.$scrollElement[0])||(t="position",e=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var n=this;this.$body.find(this.selector).map(function(){var n=$(this),i=n.data("target")||n.attr("href"),s=/^#./.test(i)&&$(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+e,i]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){n.offsets.push(this[0]),n.targets.push(this[1])})},t.prototype.process=function(){var t=this.$scrollElement.scrollTop()+this.options.offset,e=this.getScrollHeight(),n=this.options.offset+e-this.$scrollElement.height(),i=this.offsets,s=this.targets,r=this.activeTarget,o;if(this.scrollHeight!=e&&this.refresh(),t>=n)return r!=(o=s[s.length-1])&&this.activate(o);if(r&&t<=i[0])return r!=(o=s[0])&&this.activate(o);for(o=i.length;o--;)r!=s[o]&&t>=i[o]&&(!i[o+1]||t<=i[o+1])&&this.activate(s[o])},t.prototype.activate=function(t){this.activeTarget=t,$(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=$(e).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=$.fn.scrollspy;$.fn.scrollspy=e,$.fn.scrollspy.Constructor=t,$.fn.scrollspy.noConflict=function(){return $.fn.scrollspy=n,this},$(window).on("load.bs.scrollspy.data-api",function(){$('[data-spy="scroll"]').each(function(){var t=$(this);e.call(t,t.data())})})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.tab");i||n.data("bs.tab",i=new e(this)),"string"==typeof t&&i[t]()})}var e=function(t){this.element=$(t)};e.VERSION="3.2.0",e.prototype.show=function(){var t=this.element,e=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var i=e.find(".active:last a")[0],s=$.Event("show.bs.tab",{relatedTarget:i});if(t.trigger(s),!s.isDefaultPrevented()){var r=$(n);this.activate(t.closest("li"),e),this.activate(r,r.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:i})})}}},e.prototype.activate=function(t,e,n){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var s=e.find("> .active"),r=n&&$.support.transition&&s.hasClass("fade");r?s.one("bsTransitionEnd",i).emulateTransitionEnd(150):i(),s.removeClass("in")};var n=$.fn.tab;$.fn.tab=t,$.fn.tab.Constructor=e,$.fn.tab.noConflict=function(){return $.fn.tab=n,this},$(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t.call($(this),"show")})}(jQuery),+function($){"use strict";function t(t){return this.each(function(){var n=$(this),i=n.data("bs.affix"),s="object"==typeof t&&t;i||n.data("bs.affix",i=new e(this,s)),"string"==typeof t&&i[t]()})}var e=function(t,n){this.options=$.extend({},e.DEFAULTS,n),this.$target=$(this.options.target).on("scroll.bs.affix.data-api",$.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",$.proxy(this.checkPositionWithEventLoop,this)),this.$element=$(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};e.VERSION="3.2.0",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=$(document).height(),n=this.$target.scrollTop(),i=this.$element.offset(),s=this.options.offset,r=s.top,o=s.bottom;"object"!=typeof s&&(o=r=s),"function"==typeof r&&(r=s.top(this.$element)),"function"==typeof o&&(o=s.bottom(this.$element));var a=null!=this.unpin&&n+this.unpin<=i.top?!1:null!=o&&i.top+this.$element.height()>=t-o?"bottom":null!=r&&r>=n?"top":!1;if(this.affixed!==a){null!=this.unpin&&this.$element.css("top","");var l="affix"+(a?"-"+a:""),c=$.Event(l+".bs.affix");this.$element.trigger(c),c.isDefaultPrevented()||(this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(l).trigger($.Event(l.replace("affix","affixed"))),"bottom"==a&&this.$element.offset({top:t-this.$element.height()-o}))}}};var n=$.fn.affix;$.fn.affix=t,$.fn.affix.Constructor=e,$.fn.affix.noConflict=function(){return $.fn.affix=n,this},$(window).on("load",function(){$('[data-spy="affix"]').each(function(){var e=$(this),n=e.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.call(e,n)})})}(jQuery),!function($){"use strict";function t(t){return ko.isObservable(t)&&!(void 0===t.destroyAll)}function e(t,e){for(var n=0;n<t.length;++n)e(t[n])}function n(t,e){this.$select=$(t),this.options=this.mergeOptions($.extend({},e,this.$select.data())),this.originalOptions=this.$select.clone()[0].options,this.query="",this.searchTimeout=null,this.options.multiple="multiple"===this.$select.attr("multiple"),this.options.onChange=$.proxy(this.options.onChange,this),this.options.onDropdownShow=$.proxy(this.options.onDropdownShow,this),this.options.onDropdownHide=$.proxy(this.options.onDropdownHide,this),this.options.onDropdownShown=$.proxy(this.options.onDropdownShown,this),this.options.onDropdownHidden=$.proxy(this.options.onDropdownHidden,this),this.buildContainer(),this.buildButton(),this.buildDropdown(),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&$("option",this.$select).length<=0&&this.disable(),this.$select.hide().after(this.$container)}"undefined"!=typeof ko&&ko.bindingHandlers&&!ko.bindingHandlers.multiselect&&(ko.bindingHandlers.multiselect={init:function(n,i,s,r,o){var a=s().selectedOptions,l=ko.utils.unwrapObservable(i());$(n).multiselect(l),t(a)&&($(n).multiselect("select",ko.utils.unwrapObservable(a)),a.subscribe(function(t){var i=[],s=[];e(t,function(t){switch(t.status){case"added":i.push(t.value);break;case"deleted":s.push(t.value)}}),i.length>0&&$(n).multiselect("select",i),s.length>0&&$(n).multiselect("deselect",s)},null,"arrayChange"))},update:function(e,n,i,s,r){var o=i().options,a=$(e).data("multiselect"),l=ko.utils.unwrapObservable(n());t(o)&&o.subscribe(function(t){$(e).multiselect("rebuild")}),a?a.updateOriginalOptions():$(e).multiselect(l)}}),n.prototype={defaults:{buttonText:function(t,e){if(0===t.length)return this.nonSelectedText+' <b class="caret"></b>';if(t.length==$("option",$(e)).length)return this.allSelectedText+' <b class="caret"></b>';if(t.length>this.numberDisplayed)return t.length+" "+this.nSelectedText+' <b class="caret"></b>';var n="";return t.each(function(){var t=void 0!==$(this).attr("label")?$(this).attr("label"):$(this).html();n+=t+", "}),n.substr(0,n.length-2)+' <b class="caret"></b>'},buttonTitle:function(t,e){if(0===t.length)return this.nonSelectedText;var n="";return t.each(function(){n+=$(this).text()+", "}),n.substr(0,n.length-2)},label:function(t){return $(t).attr("label")||$(t).html()},onChange:function(t,e){},onDropdownShow:function(t){},onDropdownHide:function(t){},onDropdownShown:function(t){},onDropdownHidden:function(t){},buttonClass:"btn btn-default",buttonWidth:"auto",buttonContainer:'<div class="btn-group" />',dropRight:!1,selectedClass:"active",maxHeight:!1,checkboxName:!1,includeSelectAllOption:!1,includeSelectAllIfMoreThan:0,selectAllText:" Select all",selectAllValue:"multiselect-all",selectAllName:!1,enableFiltering:!1,enableCaseInsensitiveFiltering:!1,enableClickableOptGroups:!1,filterPlaceholder:"Search",filterBehavior:"text",includeFilterClearBtn:!0,preventInputChangeEvent:!1,nonSelectedText:"None selected",nSelectedText:"selected",allSelectedText:"All selected",numberDisplayed:3,disableIfEmpty:!1,templates:{button:'<button type="button" class="multiselect dropdown-toggle btn btn-default" data-toggle="dropdown"></button>',ul:'<ul class="multiselect-container dropdown-menu"></ul>',filter:'<li class="multiselect-item filter"><div class="input-group"><span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span><input class="form-control multiselect-search" type="text"></div></li>',filterClearBtn:'<span class="input-group-btn"><button class="btn btn-default multiselect-clear-filter" type="button"><i class="glyphicon glyphicon-remove-circle"></i></button></span>',li:'<li><a href="javascript:void(0);"><label></label></a></li>',divider:'<li class="multiselect-item divider"></li>',liGroup:'<li class="multiselect-item multiselect-group"><label></label></li>'}},constructor:n,buildContainer:function(){this.$container=$(this.options.buttonContainer),this.$container.on("show.bs.dropdown",this.options.onDropdownShow),this.$container.on("hide.bs.dropdown",this.options.onDropdownHide),this.$container.on("shown.bs.dropdown",this.options.onDropdownShown),this.$container.on("hidden.bs.dropdown",this.options.onDropdownHidden)},buildButton:function(){this.$button=$(this.options.templates.button).addClass(this.options.buttonClass),this.$select.prop("disabled")?this.disable():this.enable(),this.options.buttonWidth&&"auto"!==this.options.buttonWidth&&(this.$button.css({width:this.options.buttonWidth}),this.$container.css({width:this.options.buttonWidth}));var t=this.$select.attr("tabindex");t&&this.$button.attr("tabindex",t),this.$container.prepend(this.$button)},buildDropdown:function(){this.$ul=$(this.options.templates.ul),this.options.dropRight&&this.$ul.addClass("pull-right"),this.options.maxHeight&&this.$ul.css({"max-height":this.options.maxHeight+"px","overflow-y":"auto","overflow-x":"hidden"}),this.$container.append(this.$ul)},buildDropdownOptions:function(){this.$select.children().each($.proxy(function(t,e){var n=$(e),i=n.prop("tagName").toLowerCase();n.prop("value")!==this.options.selectAllValue&&("optgroup"===i?this.createOptgroup(e):"option"===i&&("divider"===n.data("role")?this.createDivider():this.createOptionValue(e)))},this)),$("li input",this.$ul).on("change",$.proxy(function(t){var e=$(t.target),n=e.prop("checked")||!1,i=e.val()===this.options.selectAllValue;this.options.selectedClass&&(n?e.closest("li").addClass(this.options.selectedClass):e.closest("li").removeClass(this.options.selectedClass));var s=e.val(),r=this.getOptionByValue(s),o=$("option",this.$select).not(r),a=$("input",this.$container).not(e);return i&&(n?this.selectAll():this.deselectAll()),i||(n?(r.prop("selected",!0),this.options.multiple?r.prop("selected",!0):(this.options.selectedClass&&$(a).closest("li").removeClass(this.options.selectedClass),$(a).prop("checked",!1),o.prop("selected",!1),this.$button.click()),"active"===this.options.selectedClass&&o.closest("a").css("outline","")):r.prop("selected",!1)),this.$select.change(),this.updateButtonText(),this.updateSelectAll(),this.options.onChange(r,n),this.options.preventInputChangeEvent?!1:void 0},this)),$("li a",this.$ul).on("touchstart click",function(t){t.stopPropagation();var e=$(t.target);if(t.shiftKey){var n=e.prop("checked")||!1;if(n){var i=e.closest("li").siblings('li[class="active"]:first'),s=e.closest("li").index(),r=i.index();s>r?e.closest("li").prevUntil(i).each(function(){$(this).find("input:first").prop("checked",!0).trigger("change")}):e.closest("li").nextUntil(i).each(function(){$(this).find("input:first").prop("checked",!0).trigger("change")})}}e.blur()}),this.$container.off("keydown.multiselect").on("keydown.multiselect",$.proxy(function(t){if(!$('input[type="text"]',this.$container).is(":focus"))if(9===t.keyCode&&this.$container.hasClass("open"))this.$button.click();else{var e=$(this.$container).find("li:not(.divider):not(.disabled) a").filter(":visible");if(!e.length)return;var n=e.index(e.filter(":focus"));38===t.keyCode&&n>0?n--:40===t.keyCode&&n<e.length-1?n++:~n||(n=0);var i=e.eq(n);if(i.focus(),32===t.keyCode||13===t.keyCode){var s=i.find("input");s.prop("checked",!s.prop("checked")),s.change()}t.stopPropagation(),t.preventDefault()}},this)),this.options.enableClickableOptGroups&&this.options.multiple&&$("li.multiselect-group",this.$ul).on("click",$.proxy(function(t){t.stopPropagation();var e=$(t.target).parent(),n=e.nextUntil("li.multiselect-group"),i=!0,s=n.find("input");s.each(function(){i=i&&$(this).prop("checked")}),s.prop("checked",!i).trigger("change")},this))},createOptionValue:function(t){var e=$(t);e.is(":selected")&&e.prop("selected",!0);var n=this.options.label(t),i=e.val(),s=this.options.multiple?"checkbox":"radio",r=$(this.options.templates.li),o=$("label",r);o.addClass(s);var a=$("<input/>").attr("type",s);this.options.checkboxName&&a.attr("name",this.options.checkboxName),o.append(a);var l=e.prop("selected")||!1;a.val(i),i===this.options.selectAllValue&&(r.addClass("multiselect-item multiselect-all"),a.parent().parent().addClass("multiselect-all")),o.append(" "+n),o.attr("title",e.attr("title")),this.$ul.append(r),e.is(":disabled")&&a.attr("disabled","disabled").prop("disabled",!0).closest("a").attr("tabindex","-1").closest("li").addClass("disabled"),a.prop("checked",l),l&&this.options.selectedClass&&a.closest("li").addClass(this.options.selectedClass)},createDivider:function(t){var e=$(this.options.templates.divider);this.$ul.append(e)},createOptgroup:function(t){var e=$(t).prop("label"),n=$(this.options.templates.liGroup);$("label",n).text(e),this.options.enableClickableOptGroups&&n.addClass("multiselect-group-clickable"),this.$ul.append(n),$(t).is(":disabled")&&n.addClass("disabled"),$("option",t).each($.proxy(function(t,e){this.createOptionValue(e)},this))},buildSelectAll:function(){var t=this.hasSelectAll();if(!t&&this.options.includeSelectAllOption&&this.options.multiple&&$("option",this.$select).length>this.options.includeSelectAllIfMoreThan){this.options.includeSelectAllDivider&&this.$ul.prepend($(this.options.templates.divider));var e=$(this.options.templates.li);$("label",e).addClass("checkbox"),$("label",e).append(this.options.selectAllName?'<input type="checkbox" name="'+this.options.selectAllName+'" />':'<input type="checkbox" />');var n=$("input",e);n.val(this.options.selectAllValue),e.addClass("multiselect-item multiselect-all"),n.parent().parent().addClass("multiselect-all"),$("label",e).append(" "+this.options.selectAllText),this.$ul.prepend(e),n.prop("checked",!1)}},buildFilter:function(){if(this.options.enableFiltering||this.options.enableCaseInsensitiveFiltering){var t=Math.max(this.options.enableFiltering,this.options.enableCaseInsensitiveFiltering);if(this.$select.find("option").length>=t){if(this.$filter=$(this.options.templates.filter),$("input",this.$filter).attr("placeholder",this.options.filterPlaceholder),this.options.includeFilterClearBtn){var e=$(this.options.templates.filterClearBtn);e.on("click",$.proxy(function(t){clearTimeout(this.searchTimeout),this.$filter.find(".multiselect-search").val(""),$("li",this.$ul).show().removeClass("filter-hidden"),this.updateSelectAll()},this)),this.$filter.find(".input-group").append(e)}this.$ul.prepend(this.$filter),this.$filter.val(this.query).on("click",function(t){t.stopPropagation()}).on("input keydown",$.proxy(function(t){13===t.which&&t.preventDefault(),clearTimeout(this.searchTimeout),this.searchTimeout=this.asyncFunction($.proxy(function(){if(this.query!==t.target.value){this.query=t.target.value;var e,n;$.each($("li",this.$ul),$.proxy(function(t,i){var s=$("input",i).val(),r=$("label",i).text(),o="";if("text"===this.options.filterBehavior?o=r:"value"===this.options.filterBehavior?o=s:"both"===this.options.filterBehavior&&(o=r+"\n"+s),s!==this.options.selectAllValue&&r){var a=!1;this.options.enableCaseInsensitiveFiltering&&o.toLowerCase().indexOf(this.query.toLowerCase())>-1?a=!0:o.indexOf(this.query)>-1&&(a=!0),$(i).toggle(a).toggleClass("filter-hidden",!a),$(this).hasClass("multiselect-group")?(e=i,n=a):(a&&$(e).show().removeClass("filter-hidden"),!a&&n&&$(i).show().removeClass("filter-hidden"))}},this))}this.updateSelectAll()},this),300,this)},this))}}},destroy:function(){this.$container.remove(),this.$select.show(),this.$select.data("multiselect",null)},refresh:function(){$("option",this.$select).each($.proxy(function(t,e){var n=$("li input",this.$ul).filter(function(){return $(this).val()===$(e).val()});$(e).is(":selected")?(n.prop("checked",!0),this.options.selectedClass&&n.closest("li").addClass(this.options.selectedClass)):(n.prop("checked",!1),this.options.selectedClass&&n.closest("li").removeClass(this.options.selectedClass)),$(e).is(":disabled")?n.attr("disabled","disabled").prop("disabled",!0).closest("li").addClass("disabled"):n.prop("disabled",!1).closest("li").removeClass("disabled")},this)),this.updateButtonText(),this.updateSelectAll()},select:function(t,e){$.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(null!==i&&void 0!==i){var s=this.getOptionByValue(i),r=this.getInputByValue(i);void 0!==s&&void 0!==r&&(this.options.multiple||this.deselectAll(!1),this.options.selectedClass&&r.closest("li").addClass(this.options.selectedClass),r.prop("checked",!0),s.prop("selected",!0))}}this.updateButtonText(),this.updateSelectAll(),e&&1===t.length&&this.options.onChange(s,!0)},clearSelection:function(){this.deselectAll(!1),this.updateButtonText(),this.updateSelectAll()},deselect:function(t,e){$.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++){var i=t[n];if(null!==i&&void 0!==i){var s=this.getOptionByValue(i),r=this.getInputByValue(i);void 0!==s&&void 0!==r&&(this.options.selectedClass&&r.closest("li").removeClass(this.options.selectedClass),r.prop("checked",!1),s.prop("selected",!1))}}this.updateButtonText(),this.updateSelectAll(),e&&1===t.length&&this.options.onChange(s,!1)},selectAll:function(t){var t="undefined"==typeof t?!0:t,e=$("li input[type='checkbox']:enabled",this.$ul),n=e.filter(":visible"),i=e.length,s=n.length;if(t?(n.prop("checked",!0),$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").addClass(this.options.selectedClass)):(e.prop("checked",!0),$("li:not(.divider):not(.disabled)",this.$ul).addClass(this.options.selectedClass)),i===s||t===!1)$("option:enabled",this.$select).prop("selected",!0);else{var r=n.map(function(){return $(this).val()}).get();$("option:enabled",this.$select).filter(function(t){return-1!==$.inArray($(this).val(),r)}).prop("selected",!0)}},deselectAll:function(t){var t="undefined"==typeof t?!0:t;if(t){var e=$("li input[type='checkbox']:enabled",this.$ul).filter(":visible");e.prop("checked",!1);var n=e.map(function(){return $(this).val()}).get();$("option:enabled",this.$select).filter(function(t){return-1!==$.inArray($(this).val(),n)}).prop("selected",!1),this.options.selectedClass&&$("li:not(.divider):not(.disabled)",this.$ul).filter(":visible").removeClass(this.options.selectedClass)}else $("li input[type='checkbox']:enabled",this.$ul).prop("checked",!1),$("option:enabled",this.$select).prop("selected",!1),this.options.selectedClass&&$("li:not(.divider):not(.disabled)",this.$ul).removeClass(this.options.selectedClass)},rebuild:function(){this.$ul.html(""),this.options.multiple="multiple"===this.$select.attr("multiple"),this.buildSelectAll(),this.buildDropdownOptions(),this.buildFilter(),this.updateButtonText(),this.updateSelectAll(),this.options.disableIfEmpty&&$("option",this.$select).length<=0&&this.disable(),this.options.dropRight&&this.$ul.addClass("pull-right")},dataprovider:function(t){var n="",i=0,s=$("");$.each(t,function(t,r){var o;$.isArray(r.children)?(i++,o=$("<optgroup/>").attr({label:r.label||"Group "+i}),e(r.children,function(t){o.append($("<option/>").attr({value:t.value,label:t.label||t.value,title:t.title,selected:!!t.selected}))}),n+="</optgroup>"):o=$("<option/>").attr({value:r.value,label:r.label||r.value,title:r.title,selected:!!r.selected}),s=s.add(o)}),this.$select.empty().append(s),this.rebuild()},enable:function(){this.$select.prop("disabled",!1),this.$button.prop("disabled",!1).removeClass("disabled")},disable:function(){this.$select.prop("disabled",!0),this.$button.prop("disabled",!0).addClass("disabled")},setOptions:function(t){this.options=this.mergeOptions(t)},mergeOptions:function(t){return $.extend(!0,{},this.defaults,t)},hasSelectAll:function(){return $("li."+this.options.selectAllValue,this.$ul).length>0},updateSelectAll:function(){if(this.hasSelectAll()){var t=$("li:not(.multiselect-item):not(.filter-hidden) input:enabled",this.$ul),e=t.length,n=t.filter(":checked").length,i=$("li."+this.options.selectAllValue,this.$ul),s=i.find("input");n>0&&n===e?(s.prop("checked",!0),i.addClass(this.options.selectedClass)):(s.prop("checked",!1),i.removeClass(this.options.selectedClass))}},updateButtonText:function(){var t=this.getSelected();$(".multiselect",this.$container).html(this.options.buttonText(t,this.$select)),$(".multiselect",this.$container).attr("title",this.options.buttonTitle(t,this.$select))},getSelected:function(){return $("option",this.$select).filter(":selected")},getOptionByValue:function(t){for(var e=$("option",this.$select),n=t.toString(),i=0;i<e.length;i+=1){var s=e[i];if(s.value===n)return $(s)}},getInputByValue:function(t){for(var e=$("li input",this.$ul),n=t.toString(),i=0;i<e.length;i+=1){var s=e[i];if(s.value===n)return $(s)}},updateOriginalOptions:function(){this.originalOptions=this.$select.clone()[0].options},asyncFunction:function(t,e,n){var i=Array.prototype.slice.call(arguments,3);return setTimeout(function(){t.apply(n||window,i)},e)}},$.fn.multiselect=function(t,e,i){return this.each(function(){var s=$(this).data("multiselect"),r="object"==typeof t&&t;s||(s=new n(this,r),$(this).data("multiselect",s)),"string"==typeof t&&(s[t](e,i),"destroy"===t&&$(this).data("multiselect",!1))})},$.fn.multiselect.Constructor=n,$(function(){$("select[data-role=multiselect]").multiselect()})}(window.jQuery),function(){console.log("WEBAC KONFIGURATOR: V3 - 07.01"),window.Webac={Models:{},Collections:{},Views:{},queryObject:{}},window.template=function(t){return _.template($("#"+t).html())},Webac.vents=_.extend({},Backbone.Events),Webac.filterList=[],Webac.anwendungsgebiete={},Webac.currentAntwenungsgebiet="",Webac.lastSelectionBox1="",Webac.lastSelectionBox2="",Webac.lastSelectionBox3="",Webac.resetApp=function(){console.log("reset"),Webac.productsCollection.reset(Webac.initialProductsCollection.toJSON()),$(".anwendungsgebiete .anwendungsgebiet").slideUp(0),$("#productsView .product").hide(),Webac.queryObject={},Webac.lastSelectionBox1="",Webac.lastSelectionBox2="",Webac.lastSelectionBox3="",Webac.currentAntwenungsgebiet=""},Webac.showSteps=function(){$(".multiselect-container").each(function(t){var e=$(this).find(".active").length;next=t+1,e&&(console.log(t+" has "+e+"  (Next is "+next+")"),$(".btn-group:eq("+next+")").addClass("active"))})},Webac.activateMultiselect=function(){$("select.multiselect").val([]),$(".multiselect").multiselect("destroy"),$(".multiselect").multiselect({buttonClass:"btn",buttonWidth:"auto",maxHeight:!1,buttonText:function(t,e){return 0===t.length?e.attr("data-name"):t.length>0?e.attr("data-name")+" ("+t.length+")":e.attr("data-name")},onChange:function(t,e){console.log("C H A N G E"),"1"==t.parents(".multiselect").attr("data-name")&&(Webac.lastSelectionBox1=t.val(),Webac.showHint(2)),"2"==t.parents(".multiselect").attr("data-name")&&(Webac.lastSelectionBox2=t.val(),Webac.showHint(3)),"3"==t.parents(".multiselect").attr("data-name")&&(Webac.lastSelectionBox3=t.val(),Webac.showHint(4)),filtername=t.parent().attr("data-name"),Webac.vents.trigger("selectChanged",t,filtername,e)}}),$('input[value="'+Webac.lastSelectionBox1+'"]').attr("checked",!0).parent(".checkbox").addClass("active"),$('input[value="'+Webac.lastSelectionBox2+'"]').attr("checked",!0).parent(".checkbox").addClass("active"),$('input[value="'+Webac.lastSelectionBox3+'"]').attr("checked",!0).parent(".checkbox").addClass("active")},Webac.resetFilters=function(){$("#searchTitle").val(""),$("select.multiselect").val([]),$("select.multiselect").multiselect("refresh"),Webac.vents.trigger("selectChanged")},Webac.showHint=function(t){console.log("showHint: "+t),all=$(".hint"),el=$(".hint").eq(t),TweenLite.to(all,0,{marginTop:-10,opacity:0}),TweenLite.to(el,2,{marginTop:0,opacity:1,delay:.5,ease:Elastic.easeOut})},Webac.Models.Products=Backbone.DeepModel.extend({defaults:{title:"im am the default Title",link:"http://www.google.de"},sync:function(){return!1},display:function(){return this.get("title")+" is displaying"}}),Webac.Views.Product=Backbone.View.extend({tagName:"div",className:"product",events:{"click strong":"showAlert","click button":"destroy"},template:template("productTemplate"),initialize:function(){this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},render:function(){var t=this.model.get("id");return this.$el.html(this.template(this.model.toJSON())).attr("id","product"+t),Webac.vents.trigger("productAdded"),this},showAlert:function(){var t=prompt("edit the Title:",this.model.get("title"));t&&this.model.set("title",t)},destroy:function(){this.model.destroy()},remove:function(){this.$el.remove()}}),Webac.Views.Products=Backbone.View.extend({tagName:"div",initialize:function(){this.collection.on("add",this.addOne,this),this.collection.on("reset",this.render,this),Webac.vents.on("startSearch",this.search,this)},render:function(){return console.log("++render View: Products++"),this.$el.html(""),this.collection.each(this.addOne,this),this},renderFiltered:function(t){return $("#productsView").html(""),t.each(function(t){var e=new Webac.Views.Product({model:t,collection:this.collection});$("#productsView").append(e.render().el)}),this},addOne:function(t){var e=new Webac.Views.Product({model:t});this.$el.append(e.render().el)}}),Webac.Views.Selection=Backbone.View.extend({tagName:"div",className:"selection",events:{"click a":"showSelect"},template:template("anwendungsSelectTemplate"),initialize:function(){},render:function(){var t=this.options.anwendungsgebietName,e=this.options.image;return this.$el.append(this.template({name:t,image:e})),this},showSelect:function(){Webac.resetApp();var t=this.options.anwendungsgebietName;Webac.queryObject={Anwendungsgebiet:t},filteredProducts=Webac.initialProductsCollection.query(Webac.queryObject),Webac.productsCollection.reset(filteredProducts),Webac.currentAntwenungsgebiet=t;var e=this.options.id;Webac.showHint(1),$(".anwendungsgebiete .anwendungsgebiet").slideUp(0),$(".anwendungsgebiete .anwendungsgebiet").eq(e).slideDown()},remove:function(){}}),Webac.Views.Selections=Backbone.View.extend({tagName:"div",className:"selections",initialize:function(){this.collection.on("reset",this.render,this)},render:function(){console.log("++render View: Selcections++"),this.$el.html("");var t=0;return _.each(Webac.anwendungsgebiete,function(e,n){console.log("redering anwendungsauswahl");var i=e.image,s=n,r=new Webac.Views.Selection({anwendungsgebietName:s,id:t,image:i});this.$el.append(r.render().el),t++},this),this}}),Webac.Views.Anwendungsgebiet=Backbone.View.extend({tagName:"div",className:"anwendungsgebiet",template:template("anwendungsgebietTemplate"),initialize:function(){},render:function(){var t=this.options.name;this.$el.append(this.template({name:t})),_.each(Webac.anwendungsgebiete[t],function(e,n){"image"!=n&&(Webac.newfilterView=new Webac.Views.FilterNew({anwendungsgebietName:t,spalte:n,optionsArray:e}),Webac.newfilterView.render(),this.$el.append(Webac.newfilterView.el))},this)}}),Webac.Views.Anwendungsgebiete=Backbone.View.extend({tagName:"div",className:"anwendungsgebiete",initialize:function(){this.create(),Webac.vents.on("selectChanged",this.updateQueryObject,this),this.collection.on("reset",this.createAnwendungsgebietList,this),Webac.showHint(0)
},create:function(){this.createAnwendungsgebietList()},createAnwendungsgebietList:function(){Webac.anwendungsgebiete={},console.log("++create Anwendungsgebiet Liste++"),this.collection.each(function(t){var e=t.get("Anwendungsgebiet");Webac.anwendungsgebiete[e]||(Webac.anwendungsgebiete[e]={})}),Webac.productsCollection.each(function(t){var e=t.get("Anwendungsgebiet"),n=t.get("filterable"),i=t.get("image"),s=t.get("title");_.each(n,function(t,n){Webac.anwendungsgebiete[e][n]||(Webac.anwendungsgebiete[e][n]=[]),Webac.anwendungsgebiete[e][n]=_.uniq(Webac.anwendungsgebiete[e][n].concat(t))}),Webac.anwendungsgebiete[e].image=i}),this.render(),Webac.activateMultiselect(),$(".btn-group:eq(0)").addClass("active"),Webac.showSteps()},render:function(){return this.$el.html(""),console.log("++render View: Anwendungsgebiete++"),_.each(Webac.anwendungsgebiete,function(t,e){Webac.anwendungsgebietView=new Webac.Views.Anwendungsgebiet({collection:Webac.productsCollection,name:e}),Webac.anwendungsgebietView.render(),this.$el.append(Webac.anwendungsgebietView.el)},this),this},updateQueryObject:function(){$("select.multiselect").each(function(){filtername="filterable."+$(this).attr("data-name"),selected={$all:$(this).val()},Webac.queryObject.Anwendungsgebiet=Webac.currentAntwenungsgebiet,null!=$(this).val()&&(Webac.queryObject[filtername]=selected)}),console.log("Construct new Query:"),console.log(Webac.queryObject),filteredProducts=Webac.initialProductsCollection.query(Webac.queryObject),console.log("THE RESULT IS: "),console.log(filteredProducts),Webac.productsCollection.reset(filteredProducts)}}),Webac.Views.FilterNew=Backbone.View.extend({tagName:"select",className:"multiselect",template:template("filterTemplate"),initialize:function(){this.$el.attr("data-name",this.options.spalte),this.$el.attr("multiple","multiple")},render:function(t){_.each(this.options.optionsArray,function(t,e){this.$el.append(this.template({optionName:t}))},this)}}),Webac.Collections.Products=Backbone.QueryCollection.extend({model:Webac.Models.Products}),Webac.productsCollection=new Webac.Collections.Products(data),Webac.initialProductsCollection=new Webac.Collections.Products(Webac.productsCollection.toJSON()),Webac.anwendungsgebieteView=new Webac.Views.Anwendungsgebiete({collection:Webac.productsCollection}),$("#anwendungsgebiete").append(Webac.anwendungsgebieteView.el),Webac.anwendungsSelectionsView=new Webac.Views.Selections({collection:Webac.productsCollection}),$("#anwendungsSelections").append(Webac.anwendungsSelectionsView.render().el),Webac.productsView=new Webac.Views.Products({collection:Webac.productsCollection}),$("#productsView").append(Webac.productsView.render().el),Webac.activateMultiselect(),$(".anwendungsgebiete .anwendungsgebiet").hide(),$(".product").hide(),TweenLite.to($("#webacAPP"),.5,{opacity:1,delay:.5}),$(".restart").click(function(t){t.preventDefault(),Webac.resetApp(),Webac.showHint(0)})}();